<!DOCTYPE html>
<html>
<head>
    <title>Blockchain Casino</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/4.0.3/web3.min.js"></script>
</head>
<body>
    <h1>Welcome to the Blockchain Casino</h1>
    <button onclick="connectWallet()">Connect Wallet</button>
    <button onclick="placeBet()">Place Bet (1 EVE Token)</button>
    <p id="wallet">Wallet: Not Connected</p>
    <p id="result"></p>

    <script>
        let web3;
        let userAccount;
        const contractAddress = "0xf3357E3C8AcFd301bAE15e4E9b17eBd1628cbcc3"; // Your contract address
        const abi = [
            {
                "constant": false,
                "inputs": [],
                "name": "bet",
                "outputs": [],
                "payable": true,
                "stateMutability": "payable",
                "type": "function"
            }
        ];

        async function connectWallet() {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    await window.ethereum.request({ method: 'eth_requestAccounts' }); // Request access
                    web3 = new Web3(window.ethereum);
                    const accounts = await web3.eth.getAccounts();
                    userAccount = accounts[0];
                    document.getElementById("wallet").innerText = `Wallet: ${userAccount}`;
                    console.log("Connected account:", userAccount);
                } catch (error) {
                    console.error("User denied Metamask access:", error);
                }
            } else {
                alert("Please install Metamask to use this dApp!");
            }
        }

        async function placeBet() {
            if (!web3) {
                alert("Web3 not initialized. Please connect your wallet first.");
                return;
            }

            const casino = new web3.eth.Contract(abi, contractAddress);
            
            try {
                const transaction = await casino.methods.bet().send({
                    from: userAccount,
                    value: web3.utils.toWei("1", "ether") // Betting 1 EVE token
                });

                document.getElementById("result").innerText = "Bet placed! Check if you won!";
                console.log("Transaction successful:", transaction);
            } catch (error) {
                console.error("Transaction failed:", error);
                document.getElementById("result").innerText = "Bet failed.";
            }
        }
    </script>
</body>
</html>
